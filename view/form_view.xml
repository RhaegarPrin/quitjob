<?xml version="1.0" encoding="utf-8"?>


<odoo>

    <record id="emp_req_form" model="ir.ui.view">
        <field name="name">Employee Request Form</field>
        <field name="model">employee.req</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <field name="status" widget="statusbar"/>
                    <field name="pm_accept" invisible="1"/>
                    <field name="acct_confirm" invisible="1"/>
                </header>
                <sheet>
                    <div>
                        <field name="notes" readonly="1" class="bg-info text-white px-3 py-2 oe_read_only" nolabel="1"
                               attrs="{'invisible': [('status','in',['draft','refuse'])]}"/>
                        <field name="refuse_notes" readonly="1" class="bg-warning text-dark px-3 py-2 oe_read_only"
                               nolabel="1" attrs="{'invisible': [('status','!=','refuse')]}"/>
                    </div>
                    <group>
                        <group>
                            <field name="employee_id" string="Nhân viên" readonly="1"/>
                            <field name="job_title" string="Vị trí"/>
                            <field name="contract_id" string="Loại hợp đồng"/>
                            <field name="department_id" string="Phòng ban"/>
                            <field name="parent_id" string="Department Manager" readonly="1"/>
                            <!--                            <field name="it_id" string="IT"  attrs="{'readonly': [('status', '!=', 'draft')]}"/>-->
                        </group>

                        <group>
                            <field name="editable" invisible="1"/>
                            <field name="own_rec" invisible="1"/>
                            <field name="create_date" string="Created on" readonly="1"/>
                            <field name="req_date" string="Ngày mong muốn"
                                   attrs="{'readonly': [('editable', '!=',True)]}"/>
                            <field name="est_date" string="Ngày dự kiến nghỉ việc theo quy định"
                                   readonly="1"/>
                            <field name="dl_acc" invisible="1"/>
                            <field name="dl_pick_date" string="Thời gian DL đồng ý cho nghỉ" readonly="1"
                                   attrs="{'invisible':['|',('dl_second_accept','=',False),('dl_acc','=','no')] }"/>
                        </group>
                    </group>
                    <group string="Lý do">
                        <field name="reasons" widget="many2many_tags" options="{'no_create_edit': True}"
                               string=""
                               attrs="{'readonly': [('editable', '!=',True)]}"/>
                    </group>
                    <group string="Lý do chi tiêt">
                        <field name="specific_reason" string=""
                               attrs="{'readonly': [('editable', '!=',True)]}"/>
                    </group>
                    <div>
                        <group string="PM phỏng vấn"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="pm_interview" readonly="1" string="Note"/>
                            <field name="pm_reason" readonly="1" string="Lý do" widget="many2many_tags"
                                   options="{'no_create_edit': True}"/>
                        </group>
                        <group string="DL phỏng vấn"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="dl_interview" readonly="1" string="Note"/>
                            <field name="dl_reason" readonly="1" string="Lý do" widget="many2many_tags"
                                   options="{'no_create_edit': True}"/>
                        </group>
                        <group string="HR phỏng vấn"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="hr_interview" readonly="1" string="Note"/>
                            <field name="hr_reason" readonly="1" string="Lý do" widget="many2many_tags"
                                   options="{'no_create_edit': True}"/>
                        </group>
                        <group>
                            <!--                            <field name="hr_notes" string="NOTE"/>-->
                        </group>
                    </div>
                    <notebook attrs="{'invisible' : [('hr_accept','=',False)]}">
                        <page string="DL confirm ">
                            <form>
                                <span>
                                    <field name="dl_first_accept" readonly="1" invisible="1"
                                           attrs="{'invisible': [('dl_first_accept', '=', False)]}"/>
                                </span>
                                <span>
                                    <field name="dl_second_accept" readonly="1" invisible="1"
                                           attrs="{'invisible': [('dl_second_accept', '=', False)]}"/>
                                </span>
                            </form>
                        </page>

                        <page string="HR confirm ">
                            <form>
                                <span>
                                    <field name="hr_accept" readonly="1" invisible="1"
                                           attrs="{'invisible': [('hr_accept', '=', False)]}"/>
                                </span>
                            </form>
                        </page>
                        <page string="IT confirm">
                            <group>
                                <field name="other_asset" readonly="1" string="Tài sản khác"/>
                                <field name="Email_asset" readonly="1" string="Có giữ lại mail không"/>
                                <field name="git_account" readonly="1" string="Acc redmind và Git"/>
                            </group>
                            <span>Other
                                <field name="other_confirm" readonly="1"
                                       attrs="{'invisible': [('other_confirm', '=', False)]}"/>
                            </span>
                        </page>
                        <page string="Accountant confirm">
                            <group>
                                <field name="personal_asset" readonly="1"
                                       string="Thu hồi tài sản thiết bị cá nhân"/>
                                <field name="customer_asset" readonly="1"
                                       string="Tài sản và thiết bị khách hàng chuyển giao cho"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" groups="base.group_user"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>



    <record id="emp_req_tree" model="ir.ui.view">
        <field name="name">Emp req tree</field>
        <field name="model">employee.req</field>
        <field name="arch" type="xml">
            <tree>
                <field name="rela_user" string="user"/>
                <field name="create_date"/>
                <field name="req_date"/>
                <field name="est_date"/>
                <field name="reasons" widget="many2many_tags"/>
                <field name="status"/>
                <field name="pm_accept" string="PM Confirm"/>
                <field name="dl_second_accept" string="DL Confirm"/>
                <field name="hr_accept" string="HR Confirm"/>
                <!--                <field name="other_confirm" string="IT Confirm"/>-->
                <!--                <field name="acct_confirm" string="Accountant Confirm"/>-->
            </tree>
        </field>
    </record>


    <record id="inherited_emp_rep_form" model="ir.ui.view">
        <field name="name">inherited.dl_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_emp_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="send_req_done" type="object" string="Submit" class="oe_highlight"
                        attrs="{'invisible': [('status', '!=', 'draft')]}">Send rq
                </button>
                <button name="cancel_send_req" type="object" string="back to draft" invisible="1"/>
            </xpath>
        </field>
    </record>


    <record id="inherited_dl_rep_form" model="ir.ui.view">
        <field name="name">inherited.dl_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_dl_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="Dl_approud_1" type="object" string="Exit interview" class="oe_highlight"
                        attrs="{'invisible' : ['|',('status','not in',['dl2']),('own_rec','=',True)]}"/>
                <button name="Dl_approud_1" type="object" string="Submit" class="oe_highlight"
                        attrs="{'invisible' : ['|',('status','not in',['dl2','draft']),('own_rec','!=',True)]}"/>
                <button name="Dl_2_PM" type="object" string="Assessing for PM" class="oe_highlight"
                        attrs="{'invisible' : ['|',('status','!=','dl2'),('pm_accept','=',True)]}"/>
                <button name="call_Refuse_form" type="object" string="Refuse"
                        attrs="{'invisible' : [('status','!=','dl2')]}"/>
            </xpath>
            <xpath expr="//field[@name='employee_id']" position="replace">
                <field name="employee_id" string="Nhân viên"
                       attrs="{'readonly':[('status','not in',['dl2','draft'])]}"/>
            </xpath>

        </field>
    </record>

    <record id="inherited_pm_rep_form" model="ir.ui.view">
        <field name="name">inherited.pm_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_pm_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="PM_approud" type="object" string="Exit interview" class="oe_highlight"
                        attrs="{'invisible' : ['|',('status','not in',['pm']),('own_rec','=',True)]}"
                />
                <button name="PM_approud" type="object" string="Submit" class="oe_highlight"
                        attrs="{'invisible' : ['|',('status','!=','pm'),('own_rec','!=',True)]}"
                />
                <button name="call_Refuse_form" type="object" string="Refuse"
                        attrs="{'invisible' : [('status','!=','pm')]}"
                />
            </xpath>
            <xpath expr="//field[@name='pm_interview']" position="replace">
                <field name="pm_interview" attrs="{'readonly' : [('status','!=','send')]}"/>
            </xpath>
        </field>
    </record>

    <!--    hr view form inhr-->
    <record id="inherited_hr_rep_form" model="ir.ui.view">
        <field name="name">inherited.hr_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_hr_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="PM_approud" type="object" string="Exit interview" class="oe_highlight"
                        attrs="{'invisible' : ['|',('hr_accept','=',True),('status','not in',['hr'])] ,'invisible' :[('own_rec','=',True)]}"/>
                <button name="PM_approud" type="object" string="Submit" class="oe_highlight"
                        attrs="{'invisible' : ['|',('hr_accept','=',True),('status','!=','hr')] ,'invisible' :[('own_rec','!=',True)] }"/>
                <button name="call_Refuse_form" type="object" string="Refuse"
                        attrs="{'invisible' : ['|',('hr_accept','=',True),('status','!=','hr')]}"/>
            </xpath>
            <xpath expr="//field[@name='employee_id']" position="replace">
                <field name="employee_id" string="Nhân viên" attrs="{'readonly':[('status','not in',['pm','draft'])]}"/>
            </xpath>
            <xpath expr="//field[@name='req_date']" position="after">
                <button name="hr_update_date" string="Update" type="object" class="oe_stat_button"   icon="fa-edit"/>
            </xpath>
        </field>
    </record>

    <record id="inherited_admin_rep_form" model="ir.ui.view">
        <field name="name">inherited.admin_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_admin_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="admin_approve" type="object" string="ADMIN Approve" class="oe_highlight"
                        attrs="{'invisible' : [('status','in',['refuse','done'])]}"/>
                <button name="admin_refuse" type="object" string="Refuse"
                        attrs="{'invisible' : [('status','in',['refuse','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='employee_id']" position="replace">
                <field name="employee_id" string="Nhân viên"
                       attrs="{'readonly' : [('status','in',['refuse','done'])]}"/>
            </xpath>
        </field>
    </record>

    <record id="inherited_it_rep_form" model="ir.ui.view">
        <field name="name">inherited.it_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_it_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="it_confirm" type="object" string="IT Confirm" class="oe_highlight"
                        attrs="{'invisible':['|',('other_confirm','=',True),('status','!=','hr')] , 'invisible':['|',('other_confirm','=',True),('own_rec','=',True)]}"/>
                attrs="{'invisible':[('rala_user','=',user.id)]}"/>
                <button name="send_req" type="object" string="send req" class="oe_highlight"
                        attrs="{'invisible': [('status', '!=', 'draft')]}">Send rq
                </button>
                <button name="it_refuse_done" type="object" string="Refuse"
                        attrs="{'invisible' : ['|',('other_confirm','=',True),('status','!=','hr')], 'invisible':['|',('other_confirm','=',True),('own_rec','=',True)]}"/>

            </xpath>
            <xpath expr="//field[@name='other_asset']" position="replace">
                <field name="other_asset" string="Tài sản khác"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='Email_asset']" position="replace">
                <field name="Email_asset" string="Có giữ lại mail không"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='git_account']" position="replace">
                <field name="git_account" string="Acc redmind và Git"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='req_date']" position="replace">
                <field name="req_date" string="Ngày mong muốn"
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='reasons']" position="replace">
                <field name="reasons" widget="many2many_tags" options="{'no_create_edit': True}"
                       string=""
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='specific_reason']" position="replace">
                <field name="specific_reason" string=""
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
        </field>
    </record>

    <record id="inherited_accountant_rep_form" model="ir.ui.view">
        <field name="name">inherited.accountant_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_accountant_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="acct_confirm_" type="object" string="Accountant Confirm" class="oe_highlight"
                        attrs="{'invisible':['|',('acct_confirm','=',True),('status','!=','hr')], 'invisible':['|',('acct_confirm','=',True),('own_rec','=',True)]}"/>
                <button name="send_req" type="object" string="send req" class="oe_highlight"
                        attrs="{'invisible': [('status', '!=', 'draft')]}"/>
                <button name="accountant_refuse_done" type="object" string="Refuse"
                        attrs="{'invisible' : ['|',('acct_confirm','=',True),('status','!=','hr')], 'invisible':['|',('acct_confirm','=',True),('own_rec','=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='personal_asset']" position="replace">
                <field name="personal_asset" string="Thu hồi tài sản thiết bị cá nhân"
                       attrs="{'readonly' : ['|',('acct_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='customer_asset']" position="replace">
                <field name="customer_asset" string="Tài sản và thiết bị khách hàng chuyển giao cho"
                       attrs="{'readonly' : ['|',('acct_confirm','=',True),('status','in',['refuse','draft','done'])] }"/>
            </xpath>
            <xpath expr="//field[@name='req_date']" position="replace">
                <field name="req_date" string="Ngày mong muốn"
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='reasons']" position="replace">
                <field name="reasons" widget="many2many_tags" options="{'no_create_edit': True}"
                       string=""
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='specific_reason']" position="replace">
                <field name="specific_reason" string=""
                       attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
        </field>
    </record>
</odoo>