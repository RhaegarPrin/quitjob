<?xml version="1.0" encoding="utf-8"?>


<odoo>
    <!--    form view cơ bản của employee.re -->
    <!--    tùy từng role phía dưới sẽ kế thừa lại form này rồi chỉnh lại field-->
    <record id="emp_req_form" model="ir.ui.view">
        <field name="name">Employee Request Form</field>
        <field name="model">employee.req</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <field name="status" widget="statusbar"/>
                    <field name="pm_accept" invisible="1"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="employee_id" string="Employee" readonly="1"/>
                            <field name="job_title" string="Vị trí"/>
                            <field name="contract_id" string="Contract"/>
                            <field name="department_id" string="Department"/>
                            <field name="parent_id" string="Quản lý" readonly="1"/>
                            <!--                            <field name="it_id" string="IT"  attrs="{'readonly': [('status', '!=', 'draft')]}"/>-->
                        </group>
                        <group>
                            <field name="editable" invisible="1"/>
                            <field name="create_date" string="Created on" readonly="1"/>
                            <field name="req_date" string="Ngày mong muốn"
                                   attrs="{'readonly': [('status', '!=', 'draft'),('editable', '!=',True)]}"/>
                            <field name="est_date" string="Ngày dự kiến nghỉ việc theo quy định"
                                   attrs="{'readonly': [('status', '!=', 'draft')]}"/>
                        </group>
                    </group>
                    <group string="Lý do">
                        <field name="reasons" widget="many2many_tags" options="{'no_create_edit': True}"
                               string=""
                               attrs="{'readonly': [('status', '!=', 'draft'),('editable', '!=',True)]}"/>
                    </group>
                    <group string="Lý do chi tiêt">
                        <field name="specific_reason" string=""
                               attrs="{'readonly': [('status', '!=', 'draft'),('editable', '!=',True)]}"/>
                    </group>
                    <div>
                        <group string="PM NOTE"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="pm_interview" readonly="1" string=""/>
                        </group>
                        <group string="DL NOTE"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="dl_interview" readonly="1" string=""/>
                        </group>
                        <group string="HR NOTE"
                               groups="quitjob_manage.group_dl_user,quitjob_manage.group_pm_user,quitjob_manage.group_hr_user">
                            <field name="hr_interview" readonly="1" string=""/>
                        </group>
                        <group>
                            <!--                            <field name="hr_notes" string="NOTE"/>-->
                        </group>
                    </div>
                    <notebook attrs="{'invisible' : [('hr_accept','=',False)]}">
                        <page string="DL confirm ">
                            <form>
                                <span>DL accept 1
                                    <field name="dl_first_accept" readonly="1"
                                           attrs="{'invisible': [('dl_first_accept', '=', False)]}"/>
                                </span>
                                <span>DL accept 2
                                    <field name="dl_second_accept" readonly="1"
                                           attrs="{'invisible': [('dl_second_accept', '=', False)]}"/>
                                </span>
                            </form>
                        </page>

                        <page string="HR confirm ">
                            <group>
                                <field name="hr_notes" context="{'default_hr_notes': id}" readonly="1"
                                       string="HR Note"/>
                            </group>
                            <form>
                                <span>HR
                                    <field name="hr_accept" readonly="1"
                                           attrs="{'invisible': [('hr_accept', '=', False)]}"/>
                                </span>
                            </form>
                        </page>
                        <page string="IT confirm">
                            <group>
                                <field name="other_asset" readonly="1" string="Tài sản khác"/>
                                <field name="Email_asset" readonly="1" string="Có giữ lại mail không"/>
                                <field name="git_account" readonly="1" string="Acc redmind và Git"/>
                            </group>
                            <span>Other
                                <field name="other_confirm" readonly="1"
                                       attrs="{'invisible': [('other_confirm', '=', False)]}"/>
                            </span>
                        </page>
                        <page string="Accountant confirm">
                            <group>
                                <field name="personal_asset" readonly="1"
                                       string="Thu hồi tài sản thiết bị cá nhân"/>
                                <field name="customer_asset" readonly="1"
                                       string="Tài sản và thiết bị khách hàng chuyển giao cho"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" groups="base.group_user"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>
    <!--    form view employee req-->


    <record id="emp_req_tree" model="ir.ui.view">
        <field name="name">Emp req tree</field>
        <field name="model">employee.req</field>
        <field name="arch" type="xml">
            <tree>
                <field name="rela_user" string="user"/>
                <field name="create_date"/>
                <field name="req_date"/>
                <field name="est_date"/>
                <field name="reasons" widget="many2many_tags"/>
                <field name="status"/>
                <field name="pm_accept" string="PM Confirm"/>
                <field name="dl_second_accept" string="DL Confirm"/>
                <field name="hr_accept" string="HR Confirm"/>
                <field name="other_confirm" string="IT Confirm"/>
                <field name="acct_confirm" string="Accountant Confirm"/>
            </tree>
        </field>
    </record>

    <!--    kế thừa chỉnh lại employee.req cho  employee user  -->
    <record id="inherited_emp_rep_form" model="ir.ui.view">
        <field name="name">inherited.dl_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_emp_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="send_req" type="object" string="send req"
                        attrs="{'invisible': [('status', '!=', 'draft')]}">Send rq
                </button>
                <button name="cancel_send_req" type="object" string="back to draft"/>
            </xpath>
        </field>
    </record>
    <!--    kế thừa chỉnh lại employee.req cho  employee user  -->

    <record id="inherited_dl_rep_form" model="ir.ui.view">
        <field name="name">inherited.dl_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_dl_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="Dl_approud_1" type="object" string="DL Assessing"
                        attrs="{'invisible' : [('status','!=','dl2')]}"/>
                <button name="Dl_2_PM" type="object" string="Assessing for PM"
                        attrs="{'invisible' : ['|',('status','!=','dl2'),('pm_accept','=',True)]}"/>
                <button name="call_Refuse_form" type="object" string="Refuse"
                        attrs="{'invisible' : [('status','!=','dl2')]}"/>
            </xpath>

        </field>
    </record>

    <record id="inherited_pm_rep_form" model="ir.ui.view">
        <field name="name">inherited.pm_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_pm_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="PM_approud" type="object" string="PM Assessing"
                        attrs="{'invisible' : [('status','!=','pm')]}"
                />

                <button name="call_Refuse_form" type="object" string="Cancel"
                        attrs="{'invisible' : [('status','!=','pm')]}"
                />
            </xpath>
            <xpath expr="//field[@name='pm_interview']" position="replace">
                <field name="pm_interview" attrs="{'readonly' : [('status','!=','send')]}"/>
            </xpath>
        </field>
    </record>

    <!--    hr view form inhr-->
    <record id="inherited_hr_rep_form" model="ir.ui.view">
        <field name="name">inherited.hr_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_hr_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="PM_approud" type="object" string="HR assessing"
                        attrs="{'invisible' : ['|',('hr_accept','=',True),('status','!=','hr')]}"/>
                <button name="call_Refuse_form" type="object" string="Refuse"
                        attrs="{'invisible' : [('status','!=','hr')]}"/>
            </xpath>
            <xpath expr="//field[@name='req_date']" position="replace">
                 <field name="req_date" string="Ngày mong muốn"
                                   attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='reasons']" position="replace">
                <field name="reasons" widget="many2many_tags" options="{'no_create_edit': True}"
                               string=""
                               attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
            <xpath expr="//field[@name='specific_reason']" position="replace">
                 <field name="specific_reason" string=""
                               attrs="{'readonly': ['|',('hr_accept', '=',True),('editable', '!=',True)]}"/>
            </xpath>
        </field>
    </record>

    <record id="inherited_it_rep_form" model="ir.ui.view">
        <field name="name">inherited.it_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_it_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="it_confirm" type="object" string="Confirm"
                        attrs="{'invisible':['|',('other_confirm','=',True),('status','!=','hr')]}"/>
                <button name="send_req" type="object" string="send req"
                        attrs="{'invisible': [('status', '!=', 'draft')]}">Send rq
                </button>
            </xpath>
            <xpath expr="//field[@name='other_asset']" position="replace">
                <field name="other_asset" string="Tài sản khác"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='Email_asset']" position="replace">
                <field name="Email_asset" string="Có giữ lại mail không"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
            <xpath expr="//field[@name='git_account']" position="replace">
                <field name="git_account" string="Acc redmind và Git"
                       attrs="{'readonly' : ['|',('other_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
            </xpath>
        </field>
    </record>

    <record id="inherited_accountant_rep_form" model="ir.ui.view">
        <field name="name">inherited.accountant_req_form</field>
        <field name="model">employee.req</field>
        <field name="inherit_id" ref="emp_req_form"/>
        <field name="groups_id" eval="[(4, ref('group_accountant_user'))]"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='status']" position="before">
                <button name="acct_confirm_" type="object" string="Confirm"
                        attrs="{'invisible':['|',('acct_confirm','=',True),('status','!=','hr')]}"/>
                <button name="send_req" type="object" string="send req"
                        attrs="{'invisible': [('status', '!=', 'draft')]}"/>
            </xpath>
            <xpath expr="//field[@name='personal_asset']" position="replace">
                <field name="personal_asset" string="Thu hồi tài sản thiết bị cá nhân"
                       attrs="{'readonly' : ['|',('acct_confirm','=',True),('status','in',['refuse','draft','done'])]}"/>
                <field name="acct_confirm" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='customer_asset']" position="replace">
                <filed name="customer_asset" string="Tài sản và thiết bị khách hàng chuyển giao cho"
                       attrs="{'readonly' : ['|',('acct_confirm','=',True),('status','in',['refuse','draft','done'])] }"/>
            </xpath>
        </field>
    </record>
</odoo>